metadata:
  name: mqttupdatespoststatearea1
  labels:
    nuclio.io/project-name: b3e9d2c4-ab0b-483e-9fe3-fd02c8f235f6
spec:
  description: "Function the is called when a new message is arrived on the iot/unisasmartparking/area1 queue, //the function send the raw data to an external api rest ."
  handler: "main:handler"
  runtime: nodejs
  resources: {}
  image: "nuclio/processor-mqttupdatespoststatearea1:latest"
  minReplicas: 1
  maxReplicas: 1
  targetCPU: 75
  triggers:
    myMqttTrigger:
      class: ""
      kind: mqtt
      url: "guest:guest@192.168.1.199:1883"
      attributes:
        subscriptions:
          - qos: 0
            topic: iot/unisasmartparking/area1
  version: 1
  build:
    functionSourceCode: Y29uc3QgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKTsKdmFyIGRhdGE9e307CmV4cG9ydHMuaGFuZGxlciA9IGZ1bmN0aW9uKGNvbnRleHQsIGV2ZW50KSB7CiAgICAKICAgIHZhciBfZXZlbnQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGV2ZW50KSk7CiAgICB2YXIgX2RhdGEgPSBiaW4yc3RyaW5nKF9ldmVudC5ib2R5LmRhdGEpOwogICAgLy92YXIgX2RhdGE9IkNTVjsxOzE7YnVzeSI7CiAgICBpZigoX2RhdGErIiIpLnN0YXJ0c1dpdGgoIkNTViIpKXsKICAgICAgICAKICAgICAgICB2YXIgc3BsPSBfZGF0YS5zcGxpdCgiOyIpOyAvLyBDU1Y7aWRfc2Vuc29yO3N0YXRlCiAgICAgICAgdmFyIGpzb25fb2JqX3NlbmQgPSAie2lkX3NlbnNvcjonIitzcGxbMV0rIicsc3RhdGU6JyIrc3BsWzJdKyInLGFyZWE6JzEnfSI7CiAgICAgICAgZGF0YSA9IGpzb25fb2JqX3NlbmQ7CiAgICB9ZWxzZXsKICAgICAgICBkYXRhPV9kYXRhOyAvL2FscmVhZHkgZGVmaW5lZAogICAgfQogICAgCgogICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgICAgaG9zdDogJzE5Mi4xNjguMS4xOTknLAogICAgICAgIHBvcnQ6IDgwODAsCiAgICAgICAgcGF0aDogJy91bmlzYXNtYXJ0cGFya2luZ3Jlc3QvYXBpL3VwZGF0ZVN0YXRlJywKICAgICAgICBtZXRob2Q6ICdQVVQnLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAgICAgJ0NvbnRlbnQtTGVuZ3RoJzogZGF0YS5sZW5ndGgKICAgICAgICB9CiAgICB9OwoKICAgIHZhciByZXEgPSBodHRwLnJlcXVlc3Qob3B0aW9ucywgZnVuY3Rpb24ocmVzKSB7CiAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbygnU1RBVFVTOiAnICsgcmVzLnN0YXR1c0NvZGUpOwogICAgICAgIGNvbnRleHQubG9nZ2VyLmluZm8oJ0hFQURFUlM6ICcgKyBKU09OLnN0cmluZ2lmeShyZXMuaGVhZGVycykpOwogICAgICAgIHJlcy5zZXRFbmNvZGluZygndXRmOCcpOwogICAgICAgIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewogICAgICAgICAgICBjb250ZXh0LmxvZ2dlci5pbmZvKCdCT0RZOiAnICsgY2h1bmspOwogICAgICAgICAgICBjb250ZXh0LmNhbGxiYWNrKCJPSyIpOwogICAgICAgIH0pOwogICAgfSk7CgogICAgcmVxLm9uKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHsKICAgICAgICBjb250ZXh0LmxvZ2dlci5pbmZvKCdwcm9ibGVtIHdpdGggcmVxdWVzdDogJyArIGUubWVzc2FnZSk7CiAgICAgICAgY29udGV4dC5jYWxsYmFjaygiS08iKQogICAgfSk7CiAgICByZXEud3JpdGUoZGF0YSk7CiAgICByZXEuZW5kKCk7CgoKfTsKCmZ1bmN0aW9uIGJpbjJzdHJpbmcoYXJyYXkpewogICAgdmFyIHJlc3VsdCA9ICIiOwogICAgZm9yKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgKytpKXsKICAgICAgICByZXN1bHQrPSAoU3RyaW5nLmZyb21DaGFyQ29kZShhcnJheVtpXSkpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKfQ==
    runtimeAttributes:
      repositories: []
    codeEntryType: sourceCode
  platform: {}
  readinessTimeoutSeconds: 60
